---
title: "capeml template"
author: "information manager"
date: Sys.Date()
output: html_document
editor_options: 
  chunk_output_type: console
---

# libraries

```{r libraries}

library(capeml)
```


# people

See the `gioseml` package provides a convenience function (`gioseml::create_role`) for generating CAP LTER investigators from an ASU Global Institute of Sustainability and Innovation database. The first example in the `people` chunk (Sharon Hall) demonstrates how to generate an EML type `creator` without use of the `gioseml` tool suite - simply change `creator` to the desired role type (e.g., `metadataProvider`, `associatedParty`).

```{r people}

# if the person has an orcid, generate that first

sharonOrcid <- EML::eml$userId(directory = "https://orcid.org")
sharonOrcid$userId <- "https://orcid.org/0000-0002-8859-6691"

sharon <- EML::eml$creator(
  individualName = EML::eml$individualName(
    givenName = "Sharon",
    surName = "Hall"),
  electronicMailAddress = "sharonjhall@asu.edu",
  organizationName = "Arizona State University",
  userId = sharonOrcid
)

# creator(s) - required

cameron <- create_role(
  firstName = "cameron",
  lastName = "boehme",
  roleType = "creator")
fabio <- create_role(
  giosPersonId = 23857,
  roleType = "creator")

creators <- list(cameron, fabio)

# metadata provider - required

cameron <- create_role(
  firstName = "cameron",
  lastName = "boehme",
  roleType = "metadata")

metadataProvider <- list(cameron)

# associated party - optional
# takes the optional argument `projectRole` (default: "former project associate")
mark <- create_role(
  giosPersonId = 132,
  roleType = "associated")
nancy <- create_role(
  giosPersonId = 150,
  roleType = "associated")

associatedParty <- list(mark, nancy)

```


# keywords

```{r keywords}

write_keywords()
```


# methods

Methods are automatically read from a `methods.md` file in the project
directory. If more elaborate methods are required, e.g., to incorporate
provenance, use the enhancedMethods approach.


# coverages

```{r coverages}

# begindate <- format(min(runoff_chemistry$runoff_datetime), "%Y-%m-%d")
# enddate <- format(max(runoff_chemistry$runoff_datetime), "%Y-%m-%d")
geographicDescription <- "CAP LTER study area"
coverage <- EML::set_coverage(
  begin = "YYYY-MM-DD",
  end = "YYYY-MM-DD",
  geographicDescription = geographicDescription,
  west = -x,
  east = -x,
  north = +x,
  south = +x
)

```


# dataset

Optionally, provide: abstract, methods, keywords, publication date.

```{r construct-dataset}

dataset <- create_dataset()
```


# add dataTable

```{r dataSet$dataTable}

# add dataTables if relevant

print(ls(pattern = "_DT"))

if (length(ls(pattern = "_DT")) > 0) {

  listOfDataTables <- lapply(ls(pattern = "_DT"), function(DT) { get(DT) } )

  dataset$dataTable  <- listOfDataTables

}

# or add manually
# dataset$dataTable <- list(dataTable..., dataTable...)
```


# add otherEntity

```{r dataSet$otherEntity}

# add other entities if relevant

print(ls(pattern = "_OE"))

if (length(ls(pattern = "_OE")) > 0) {

  listOfOtherEntities <- lapply(ls(pattern = "_OE"), function(OE) { get(OE) } )

  dataset$otherEntity <- listOfOtherEntities

}

# or add manually
# dataset$otherEntity <- list(otherEntity..., otherEntity...)
```


# add spatialVector

```{r dataSet$spatialVector}

# add spatial vectors if relevant

print(ls(pattern = "_SV"))

if (length(ls(pattern = "_SV")) > 0) {

  listOfSpatialVectors <- lapply(ls(pattern = "_SV"), function(SV) { get(SV) } )

  dataset$spatialVector  <- listOfSpatialVectors

}

# or add manually
# dataset$spatialVector <- list(spatialVector..., spatialVector...)
```


# add spatialRaster

```{r dataSet$spatialRaster}

# add spatial vectors if relevant

print(ls(pattern = "_SR"))

if (length(ls(pattern = "_SR")) > 0) {

  listOfSpatialRasters <- lapply(ls(pattern = "_SR"), function(SR) { get(SR) } )

  dataset$spatialRaster  <- listOfSpatialRasters

}

# or add manually
# dataset$spatialRaster <- list(spatialRaster..., spatialRaster...)
```

# eml

```{r construct-eml, eval=TRUE}

eml <- capeml::create_eml()
```

```{r validate-eml, eval=TRUE}

EML::eml_validate(eml)
```

```{r eml-to-file, eval=TRUE}

capeml::write_cap_eml()
```
